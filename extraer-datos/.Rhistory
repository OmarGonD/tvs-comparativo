timevis(data)
data <- data.frame(
id      = 1:4,
content = c("<img src='https://www.judaicawebstore.com/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/T/h/The-Israeli-Flag-large_large.jpg'/>", "Item two"  ,"Ranged item", "Item four"),
start   = c("0000-01-10", "2016-01-11", "2016-01-20", "2016-02-14 15:00:00"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("<img src='https://www.judaicawebstore.com/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/T/h/The-Israeli-Flag-large_large.jpg'/>", "Item two"  ,"Ranged item", "Item four"),
start   = c("-4000-01-10", "2016-01-11", "2016-01-20", "2016-02-14 15:00:00"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("<img src='https://www.judaicawebstore.com/media/catalog/product/cache/1/image/9df78eab33525d08d6e5fb8d27136e95/T/h/The-Israeli-Flag-large_large.jpg'/>", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("-4000-01-10", "0000-00-00", "2016-01-20", "2016-02-14 15:00:00"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("-4000-00-00", "0000-00-00", "2016-01-20", "2016-02-14 15:00:00"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("2014-01-20","2015-01-20", "2016-01-20", "2016-02-14 15:00:00"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("2014-01-20","2015-01-20", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("-4000","2015-01-20", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Jesús El Cristo - Nacimiento"  ,"Ranged item", "Item four"),
start   = c("-4000","0000-00-00", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - AC", "Cambia la historia"  ,"Ranged item", "Item four"),
start   = c("-4000","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("-4000","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
library(timevis)
data <- data.frame(
id      = 1:4,
content = c("4000 mil años - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("-4000","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 years - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("-4000","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 years - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("-4000-01-01","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 years - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("4000-01-01","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
data <- data.frame(
id      = 1:4,
content = c("4000 years - Before JesusChrist", "History changes"  ,"Ranged item", "Item four"),
start   = c("-4000-01-01","0000-01-01", "2016-01-20", "2016-02-14"),
end     = c(NA          ,           NA, "2016-02-04", NA)
)
timevis(data)
x <- read_html("www.google.com.pe")
library(rvest)
x <- read_html("www.google.com.pe")
e <- read_html("http://had.co.nz")
e %>% html_nodes("p") %>% html_text()
ripley <- read_html("simple.ripley.com.pe")
ripley <- read_html("http://simple.ripley.com.pe")
ripley %>% html_attr('href')
read_html("http://had.co.nz")
read_html("http://simple.ripley.com.pe")
ripley %>% html_attr('href')
read_html("http://had.co.nz")
read_html("http://had.co.nz")[2]
ripley %>% html_attr('href')
page=read_html("http://www.yelp.com/search?find_loc=New+York,+NY,+USA")
page %>% html_nodes(".biz-name") %>% html_attr('href')
page=read_html("http://simple.ripley.com.pe")
page %>% html_nodes(".child-categories") %>% html_attr('href')
page %>% html_nodes(".child-categories") %>% html_attr('href') %>% html_text()
page %>% html_nodes(".child-categories") %>% html_attr('href') %>% html_text
ripley <- read_html("http://simple.ripley.com.pe")
ripley %>% html_nodes(".child-categories") %>% html_attr('href') %>% html_text
ripley %>% html_nodes(".child-categories") %>% html_text
ripley  <- trimws(ripley, "both")
ripley
library(rvest)
page=read_html("http://www.yelp.com/search?find_loc=New+York,+NY,+USA")
page %>% html_nodes(".biz-name span") %>% html_attr('href')
page=read_html("http://www.yelp.com/search?find_loc=New+York,+NY,+USA")
page %>% html_nodes(".biz-name") %>% html_attr('href')
read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category") %>% html_attr('href')
read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
path <-
length(ripley)
path <-
length(ripley)
path <-
length(ripley)
length(ripley)
ripley
ripley <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
ripley
length(ripley)
ripley <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
ripley
page <- "http://simple.ripley.com.pe/"
ripley_urls <- c()
ripley_urls
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe/"
ripley_urls <- c()
for (path in seq_along(ripley_paths)) {
ripley_urls <- c(ripley_urls, paste0(page, path, "?page=", "1"))
}
ripley_urls
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe/"
ripley_urls <- c()
for (i in seq_along(ripley_paths)) {
ripley_urls <- c(ripley_urls, paste0(page, ripley_paths[i], "?page=", "1"))
}
ripley_urls
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe"
ripley_urls <- c()
for (i in seq_along(ripley_paths)) {
ripley_urls <- c(ripley_urls, paste0(page, ripley_paths[i], "?page=", "1"))
}
ripley_urls
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe"
ripley_urls <- c()
for (i in seq_along(ripley_paths)) {
for (n in 1:11) {
ripley_urls <- c(ripley_urls, paste0(page, ripley_paths[i], "?page=", i))
}
}
ripley_urls
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe"
ripley_urls <- c()
for (i in seq_along(ripley_paths)) {
for (n in 1:11) {
ripley_urls <- c(ripley_urls, paste0(page, ripley_paths[i], "?page=", n))
}
}
ripley_urls
for (n in 1:11) {
print(n)
}
library(rvest)
ripley_paths <- read_html("http://simple.ripley.com.pe") %>%
html_nodes(".child-category-name") %>% html_attr('href')
page <- "http://simple.ripley.com.pe"
ripley_urls <- c()
for (i in seq_along(ripley_paths)) {
for (n in 1:11) {
ripley_urls <- c(ripley_urls, paste0(page, ripley_paths[i], "?page=", n))
}
}
ripley_urls
linio_paths <- read_html("https://www.linio.com.pe/c") %>%
html_attr('href')
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".nav-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".nav-link"|".subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".nav-link|.subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".nav-link|.subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes("a.subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes("a .subcategory-link") %>% html_attr('href')
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes("a .subcategory-link") %>% html_text
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".subcategory-link") %>% html_text
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes("#main-menu .subcategory-link") %>% html_attr("href")
linio_paths
library(rvest)
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".subcategory-link") %>% html_attr("href")
linio_paths
linio_paths <- read_html("https://www.linio.com.pe") %>%
html_nodes(".nav-link") %>% html_attr("href")
linio_paths
linio_paths <- read_html("https://www.linio.com.pe/directorio") %>%
html_nodes(".children-section") %>% html_attr("href")
linio_paths
linio_paths <- read_html("https://www.linio.com.pe/directorio") %>%
html_nodes(".title") %>% html_attr("href")
linio_paths
linio_paths <- read_html("https://www.linio.com.pe/directorio") %>%
html_nodes(".sub-category-title") %>% html_attr("href")
linio_paths
linio_paths <- read_html("https://www.linio.com.pe/directorio") %>%
html_nodes(".title") %>% html_attr("href")
linio_paths
#"https://www.linio.com.pe/c/computacion/b/lenovo?page=2"
library(rvest)
linio_paths <- read_html("https://www.linio.com.pe/directorio") %>%
html_nodes(".title") %>% html_attr("href")
linio_paths
linio_dominio <- "https://www.linio.com.pe"
linio_urls <- c()
for (i in seq_along(linio_paths)) {
for (n in 1:11) {
linio_urls <- c(linio_urls, paste0(linio_dominio, linio_paths[i], "?page=", n))
}
}
linio_urls
falabella_paths <- read_html("http://www.falabella.com.pe/falabella-pe/browse/siteMap.jsp") %>%
html_nodes(".linkgrismapasitio") %>% html_attr("href")
falabella_paths
falabella_paths
View(falabella_paths)
falabella_paths
a <- 1:112
df <- data.frame(a, falabella_paths)
View(df)
falabella_paths <- read_html("http://www.falabella.com.pe/falabella-pe/browse/siteMap.jsp") %>%
html_nodes(".linkgrismapasitio") %>% html_attr("href")
falabella_paths
for (i in seq_along(falabella_paths)) {
# for (n in 1:11) {
#
#   falabella_urls <- c(falabella_urls, paste0(falabella_dominio, falabella_paths[i], "?page=", n))
#
# }
print(paste0(falabella_dominio, falabella_paths))
#falabella_urls <- paste0(falabella_urls, )
}
falabella_dominio <- "https://www.falabella.com.pe"
for (i in seq_along(falabella_paths)) {
# for (n in 1:11) {
#
#   falabella_urls <- c(falabella_urls, paste0(falabella_dominio, falabella_paths[i], "?page=", n))
#
# }
print(paste0(falabella_dominio, falabella_paths))
#falabella_urls <- paste0(falabella_urls, )
}
gsub(".*(;.*)", "", falabella_paths)
gsub(".*(\\;.*)", "", falabella_paths)
gsub(".*(\\;.*)", "\\1", falabella_paths)
aa <- gsub("(.*)(;.*)", "\\1", falabella_paths)
aa
aa <- gsub("(.*)(\\;)", "\\1", falabella_paths)
aa
aa <- gsub("\\;.*", "", falabella_paths)
aa
aa <- gsub(";.*", "", falabella_paths)
aa
aa
falabella_paths
View(df)
falabella_paths[37]
gsub(";.*", "", falabella_paths[37])
for (i in seq_along(falabella_paths)) {
falabella_paths[i] <- gsub(";.*", "", falabella_paths[i])
}
falabella_paths
falabella_paths
falabella_paths[112] <- NULL
falabella_paths[!grepl("#")]
falabella_paths[!grepl("#", falabella_paths)]
falabella_paths[!grepl("#", falabella_paths)]
falabella_paths[!grepl("#|myaccount", falabella_paths)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes",
falabella_paths)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes",
falabella_paths)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|
falabellapro|",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|
falabellapro|",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|
falabellapro",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|
falabellapro|falabella\\.com\\.[ar|pe]",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|
falabellapro|falabella\\.com\\.[ar|pe]",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|falabellapro|falabella\\.com\\.[ar|pe]",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|falabellapro|falabella\\.com\\.[ar|pe],venta",
falabella_paths, ignore.case = T)]
falabella_paths[!grepl("#|myaccount|servicio|static|bancofalabella|viajes|falabellapro|falabella\\.com\\.[ar|pe]|venta",
falabella_paths, ignore.case = T)]
library(RSelenium)
library(rvest)
library(dplyr)
library(tidyr)
library(stringr)
library(urltools)
#setwd("D:\\RCoursera\\Ripley")
setwd("D:\\rls\\tvs-comparativo\\extraer-datos") #LAPTOP
#setwd("D:\\RCoursera\\r-s-l\\extraer-datos") #PC
#start RSelenium
rD  <- rsDriver(port = 4544L, browser = "firefox", version = "latest", chromever = "latest",
geckover = "latest", iedrver = NULL, phantomver = "2.1.1",
verbose = TRUE, check = TRUE)
remDr <- rD[["client"]]
#### URLS #####
ripley_urls <- read.csv2("ripley-urls-totales.csv")
###############
#### Data Lists #####
ripley_data_list <- list()
#### Extracción de datos ####
for (i in ripley_urls$url) {
remDr$navigate(i)
print(i)
Sys.sleep(03)
#1 == Categoria: Cómputo
#2 == Subcategoria: Proyectores y monitores
#3 == Producto: Monitores
categoria_url <- (str_split(path(i), "\\/")[[1]][1])
subcategoria_url <- (str_split(path(i), "\\/")[[1]][2])
producto_url <- (str_split(path(i), "\\/")[[1]][3])
page_source<-remDr$getPageSource()
product_info <- function(node){
# r.categoria <- categoria
# r.subcategoria <- subcategoria
# r.producto <- producto
r.precio.antes <- html_nodes(node, 'span.catalog-product-list-price') %>% html_text
r.precio.actual <- html_nodes(node, 'span.catalog-product-offer-price') %>% html_text
r.producto <- html_nodes(node,"span.catalog-product-name") %>% html_text
data.frame(
fecha = as.character(Sys.Date()),
ecommerce = "Ripley",
categoria_url = categoria_url,
subcategoria_url = subcategoria_url,
producto_url = producto_url,
producto = r.producto,
precio.antes = ifelse(length(r.precio.antes)==0, NA, r.precio.antes),
precio.actual = ifelse(length(r.precio.actual)==0, NA, r.precio.actual),
#tarjeta.ripley = ifelse(length(r.tarjeta)==0, NA, r.tarjeta),
stringsAsFactors=F
)
}
doc <- read_html(iconv(page_source[[1]]), to="UTF-8") %>%
html_nodes("div.product-description")
tvs <- lapply(doc, product_info) %>%
bind_rows()
ripley_data_list[[i]] <- tvs # add it to your list
}
ripley = do.call(rbind, ripley_data_list)
#ripley_tvs <- cbind(fecha = as.character(Sys.Date()), ripley_tvs)
rownames(ripley) <- NULL
#####################################################################
#####################################################################
#
# file <- paste( as.character(Sys.Date()),"ripley", sep = "-")
#
# ripley_csv <- paste(file, "csv", sep = ".")
#
#
# write.csv(ripley, ripley_csv, row.names = F)
file <- paste( as.character(Sys.Date()),"ripley", sep = "-")
ripley_csv <- paste(file, "csv", sep = ".")
write.csv(ripley, ripley_csv, row.names = F)
library(RSelenium)
library(rvest)
library(dplyr)
library(stringr)
library(urltools)
#setwd("D:\\rls\\productos-comparativo\\extraer-datos")
#setwd("D:\\RCoursera\\Falabella")
setwd("D:\\RCoursera\\r-s-l\\extraer-datos")
#start RSelenium
rD  <- rsDriver(port = 4504L, browser = "firefox", version = "latest", chromever = "latest",
geckover = "latest", iedrver = NULL, phantomver = "2.1.1",
verbose = TRUE, check = TRUE)
remDr <- rD[["client"]]
### URLS ###
falabella_urls <- read.csv("falabella-urls-totales.csv", stringsAsFactors = F)
#falabella_urls$url[1]
#############################
falabella_data_list <- list()
for (i in falabella_urls$url) {
remDr$navigate(i)
print(i)
Sys.sleep(05)
page_source<-remDr$getPageSource()
product_info <- function(node){
subcategoria_url <- str_split(path(i), "\\/")[[1]][4]
s.marca <- html_nodes(node,"div.marca a") %>% html_text
s.producto <- html_nodes(node,"div.detalle a") %>% html_attr("href")
s.precio.antes <- html_nodes(node, "div.precio2 span") %>% html_text
s.precio.actual <- html_nodes(node, "div.precio1 span") %>% html_text
#s.precio.antes <- html_nodes(node, "div.precio3 span") %>% html_text
#s.recojo.tienda <- html_nodes(node, ".ico_cuatro") %>% html_text
#s.solo.online <- html_nodes(node, ".ico_dos") %>% html_text
data.frame(
fecha = as.character(Sys.Date()),
subcategoria = subcategoria_url,
ecommerce = "Falabella",
marca = s.marca,
producto = s.producto,
precio.antes = ifelse(length(s.precio.antes) == 0, NA, s.precio.antes),
precio.actual = ifelse(length(s.precio.actual) == 0, NA, s.precio.actual),
#precio.normal = ifelse(length(s.precio.antes) == 0, NA, s.precio.antes),
#precio.internet = ifelse(length(s.precio.internet) == 0, NA, s.precio.internet),
#precio.unica = s.precio.unica,
#recojo.tienda = ifelse(length(s.recojo.tienda) == 0, NA, s.recojo.tienda),
#solo.online = ifelse(length(s.solo.online) == 0, NA, s.solo.online),
stringsAsFactors=F
)
}
doc <- read_html(iconv(page_source[[1]]), to="UTF-8") %>%
html_nodes(".cajaLP4x")
productos <- lapply(doc, product_info) %>%
bind_rows()
falabella_data_list[[i]] <- productos # add it to your list
}
falabella = do.call(rbind, falabella_data_list)
#falabella <- cbind(fecha = as.character(Sys.Date()), falabella)
rownames(falabella) <- NULL
file <- paste( as.character(Sys.Date()),"falabella", sep = "-")
falabella_csv <- paste(file, "csv", sep = ".")
write.csv(falabella, falabella_csv, row.names = F)
View(falabella)
